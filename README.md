# glueops-platform

![Version: 0.1.0](https://img.shields.io/badge/Version-0.1.0-informational?style=flat-square) ![AppVersion: v0.1.0](https://img.shields.io/badge/AppVersion-v0.1.0-informational?style=flat-square)

Deploy the ArgoCD Platform. This chart is never packaged up but gets used via `helm template` command.

## Requirements

| Repository | Name | Version |
|------------|------|---------|
| https://argoproj.github.io/argo-helm | argo-cd | 5.22.0 |

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| argo-cd.applicationSet.replicaCount | int | `2` |  |
| argo-cd.controller.replicas | int | `1` |  |
| argo-cd.glueops.destination_cluster_for_core_apps | string | `"in-cluster"` |  |
| argo-cd.glueops.enabled | bool | `false` |  |
| argo-cd.glueops.github_client_id | string | `"nil"` |  |
| argo-cd.glueops.github_client_secret | string | `"nil"` |  |
| argo-cd.glueops.ingress_controller_host_port_enabled | bool | `false` |  |
| argo-cd.glueops.ingress_controller_service_type | string | `"LoadBalancer"` |  |
| argo-cd.redis-ha.enabled | bool | `true` |  |
| argo-cd.repoServer.autoscaling.enabled | bool | `true` |  |
| argo-cd.repoServer.autoscaling.minReplicas | int | `2` |  |
| argo-cd.server.autoscaling.enabled | bool | `true` |  |
| argo-cd.server.autoscaling.minReplicas | int | `2` |  |
| argo-cd.server.config."application.resourceTrackingMethod" | string | `"annotation+label"` |  |
| argo-cd.server.config."dex.config" | string | `"connectors:\n  - type: github\n    id: github\n    name: GitHub\n    config:\n      clientID: XXXXXXXXXXXXXXXXXXXXXXXXXX\n      clientSecret: XXXXXXXXXXXXXXXXXXXXXXXXXX\n      orgs:\n      - name: GlueOps\n      - name: glueops-rocks\n      loadAllGroups: true\n"` |  |
| argo-cd.server.config."exec.enabled" | string | `"true"` |  |
| argo-cd.server.config."resource.customizations.health.argoproj.io_Application" | string | `"hs = {}\nhs.status = \"Progressing\"\nhs.message = \"\"\nif obj.status ~= nil then\n  if obj.status.health ~= nil then\n    hs.status = obj.status.health.status\n    if obj.status.health.message ~= nil then\n      hs.message = obj.status.health.message\n    end\n  end\nend\nreturn hs\n"` |  |
| argo-cd.server.config."resource.customizations.health.external-secrets.io_ExternalSecret" | string | `"hs = {}\nhs.status = \"Healthy\"\nreturn hs\n"` |  |
| argo-cd.server.config.url | string | `"https://argocd.<cluster_env>.<tenant-name-goes-here>.glueopshosted.rocks"` |  |
| argo-cd.server.extraArgs[0] | string | `"--insecure"` |  |
| argo-cd.server.ingress.annotations."kubernetes.io/ingress.class" | string | `"internal-ingress-nginx"` |  |
| argo-cd.server.ingress.enabled | bool | `true` |  |
| argo-cd.server.ingress.hosts[0] | string | `"argocd.<cluster_env>.<tenant-name-goes-here>.glueopshosted.rocks"` |  |
| argo-cd.server.rbacConfig."policy.csv" | string | `"g, GlueOps:argocd_super_admins, role:admin\ng, glueops-rocks:developers, role:developers\np, role:developers, clusters, get, *, allow\np, role:developers, *, get, development, allow\np, role:developers, repositories, *, development/*, allow\np, role:developers, applications, *, development/*, allow\np, role:developers, exec, *, development/*, allow\n"` |  |
| argo-cd.server.service.type | string | `"ClusterIP"` |  |
| captain_domain | string | `"<cluster_env>.<tenant-name-goes-here>.glueopshosted.rocks"` | The Route53 subdomain for the services on your cluster. It will be used as the suffix url for argocd, grafana, vault, and any other services that come out of the box in the glueops platform. Note: you need to create this before using this repo as this repo does not provision DNS Zones for you. |
| certManager.aws_accessKey | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` | Values are specific to certManager, due to narrowly scoped permissions, and are generated by terraform-module-cloud-multy-prerequisites. |
| certManager.aws_region | string | `"us-west-2"` | Values are specific to certManager, due to narrowly scoped permissions, and are generated by terraform-module-cloud-multy-prerequisites. |
| certManager.aws_secretKey | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` | Values are specific to certManager, due to narrowly scoped permissions, and are generated by terraform-module-cloud-multy-prerequisites. |
| certManager.zerossl_eab_hmac_key | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` | can be obtained for free with an account under zerossl.com. To retrieve these values, log in to the relevant zerossl account for your zone and navigate to the developer page. Note: For development, use a personal ZeroSSL account, and not a shared account - this avoids unintended consequences. Each customer will has a unique ZeroSSL account as well. |
| certManager.zerossl_eab_kid | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` | can be obtained for free with an account under zerossl.com. To retrieve these values, log in to the relevant zerossl account for your zone and navigate to the developer page. Note: For development, use a personal ZeroSSL account, and not a shared account - this avoids unintended consequences. Each customer will has a unique ZeroSSL account as well. |
| development_mode_enabled | bool | `false` |  |
| externalDns | object | `{"aws_accessKey":"XXXXXXXXXXXXXXXXXXXXXXXXXX","aws_region":"us-west-2","aws_secretKey":"XXXXXXXXXXXXXXXXXXXXXXXXXX"}` | Values are specific to externalDNS and generated by terraform-module-cloud-multy-prerequisites |
| gitHub.api_token | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` | create a Personal Access Token in github that has repo scope access. It would be best to use a service account for this otherwise all the comments on PR will be left in your name |
| gitHub.credentialTemplateUrl | string | `"Z2l0QGdpdGh1Yi5jb20="` | Default is `git@github.com`. We recommend leaving this as is. |
| gitHub.customer_github_org_and_team | string | `"glueops-rocks:developers"` | The format is: <github-org-name>:<github-team-name> (The team should include the developers) |
| gitHub.tenant_application_stack_repo | string | `"git@github.com:<your-org-name>/<your-repo-name>.git"` | This is the repo that will be used to store all the tenant's cluster applications. The developers will have access to this repo and will be able to create PRs to this repo. The repo should be private.  |
| gitHub.tenant_b64enc_ssh_private_key | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` | Create a deploy key to access the application stack repository it and format using `cat <key-file> | base64 | tr -d '\n'`. ref: https://docs.github.com/en/authentication/connecting-to-github-with-ssh/managing-deploy-keys#deploy-keys |
| glueops_alerts.opsgenie_apikey | string | `"nil"` | This is unique per cluster deployment. You can get these values from the terraform you use to get loki s3, vault backup, and certmanager creds. |
| glueops_backups | object | `{"vault":{"aws_accessKey":"XXXXXXXXXXXXXXXXXXXXXXXXXX","aws_region":"us-west-2","aws_secretKey":"XXXXXXXXXXXXXXXXXXXXXXXXXX","company_key":"<tenant-name-goes-here>","cron_expression":"0 */6 * * *"}}` | Configuration for backups taken by the GlueOps Platform |
| glueops_backups.vault | object | `{"aws_accessKey":"XXXXXXXXXXXXXXXXXXXXXXXXXX","aws_region":"us-west-2","aws_secretKey":"XXXXXXXXXXXXXXXXXXXXXXXXXX","company_key":"<tenant-name-goes-here>","cron_expression":"0 */6 * * *"}` | Credentials and configuration for backing up vault, values are generated by terraform-module-cloud-multy-prerequisites and are specific to this backup process, due to narrowly scoped permissions |
| grafana.github_admin_org_name | string | `"GlueOps"` |  |
| grafana.github_admin_team_name | string | `"grafana_super_admins"` |  |
| grafana.github_client_id | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` |  |
| grafana.github_client_secret | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` |  |
| grafana.github_other_org_names | string | `"glueops-rocks"` |  |
| grafana.loki_data_source_domain | string | `"http://loki-read.glueops-core-loki.svc.cluster.local:3100"` |  |
| loki.aws_accessKey | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` |  |
| loki.aws_region | string | `"us-west-2"` |  |
| loki.aws_secretKey | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` |  |
| loki.bucket | string | `"XXXXXXXXXXXXXXXXXXXXXXXXXX"` |  |
| promtail.client_url | string | `"http://loki-write.glueops-core-loki.svc.cluster.local:3100/loki/api/v1/push"` |  |
| vault.config.glues_env | string | `"nil"` |  |
